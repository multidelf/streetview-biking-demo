
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>一騎出發吧｜街景騎乘模擬器</title>
  <style>
    body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; }
    #logoHeader {
      position: absolute; top: 10px; left: 10px; z-index: 999;
      background: rgba(255, 255, 255, 0.85); border-radius: 8px;
      padding: 5px 10px; display: flex; align-items: center;
      font-weight: bold;
    }
    #logoHeader img { height: 32px; margin-right: 8px; }
    #inputGuide {
      position: absolute; top: 60px; left: 10px; z-index: 998;
      background: rgba(255,255,255,0.95); padding: 12px; max-width: 360px;
      border-left: 5px solid #4CAF50; border-radius: 5px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2); font-size: 14px;
    }
    #app {
      width: 100%;
      height: 100%;
      background-color: #eee;
    }
    select, button {
      font-size: 14px; margin-top: 8px; padding: 6px;
      border-radius: 4px; border: 1px solid #ccc; width: 100%;
    }
    #playOptions {
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <div id="logoHeader">
    <img src="assets/img/logo.jpg" alt="Logo">
    一騎出發吧｜街景騎乘模擬器
  </div>

  <div id="inputGuide">
    <h3>📌 請選擇路線來源方式</h3>
    <ol>
      <li><b>下拉選單</b>：選擇預設路線（由 Google Sheet 提供）</li>
      <li><b>貼上經緯度</b>：自行輸入 GPS 點位</li>
      <li><b>A → B 搜尋</b>：起終點查詢導航路線</li>
    </ol>
    <div>
      <label for="routeSelect">🔽 選擇路線：</label>
      <select id="routeSelect"><option>載入中...</option></select>
      <div id="playOptions">
        <label><input type="checkbox" id="autoPlayToggle" checked> 選擇後自動播放</label><br>
        <button id="manualPlayBtn">▶️ 手動開始導航</button>
      </div>
    </div>
  </div>

  <div id="app">
    <!-- 模擬器主畫面將顯示於此 -->
  </div>

  <script>
    const apiBase = "https://script.google.com/macros/s/AKfycbzctNoMZS3m3FX3q1s3Ka4ZgK-bVsMKkOh0rL9IQaS1wO1dprzkUcCpZqE4YpQW7vtA/exec";

    const routeSelect = document.getElementById("routeSelect");
    const autoPlayToggle = document.getElementById("autoPlayToggle");
    const manualPlayBtn = document.getElementById("manualPlayBtn");

    async function fetchRouteNames() {
      const res = await fetch(apiBase);
      const data = await res.json();
      routeSelect.innerHTML = data.routes.map(name => `<option value="${name}">${name}</option>`).join("");
    }

    async function fetchRoutePoints(routeName) {
      const res = await fetch(`${apiBase}?routeName=${encodeURIComponent(routeName)}`);
      const data = await res.json();
      console.log("📍 載入路線：", data.routeName);
      console.log("✅ 點列資料：", data.points);

      if (autoPlayToggle.checked) {
        // 🔁 自動播放（這裡預留觸發模擬器的程式）
        console.log("🎬 自動開始模擬器導航");
      }
    }

    routeSelect.addEventListener("change", () => {
      const name = routeSelect.value;
      if (name) fetchRoutePoints(name);
    });

    manualPlayBtn.addEventListener("click", () => {
      const name = routeSelect.value;
      if (name) fetchRoutePoints(name);
    });

    fetchRouteNames();
  </script>
</body>
</html>
